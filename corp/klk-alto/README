Set variables in file alto-xml2vrt-dirs-new.sh:
 - scriptdir
 - outputdir
 - copy_all_vrtfiles
 - linkingfile

Set variables in check-and-renumber-sentences.sh:
 - vrt_validate

Dependencies of alto-xml2vrt-dirs-new.sh:

alto-xml2vrt-dirs-new.sh
  - conv-new.py
    - vrt_util.py
      - finnish-tokenize command line tool
    - mets.py
  - mets2metadata.py
    - mets.py

Process all source directories with alto-xml2vrt-dirs-new.sh. It is probably
easiest first to split large directories into smaller ones and then generate
commands for batch scripts that should terminate within a given number of hours.

An example:

Split all directories with:

for dir in finclarin_siirto/*/*/alto;
do
    ./split-dir.sh $dir 200000;
done
for dir in finclarin_siirto/*/*/orig_alto/;
do
    rm -r $dir;
done

Then generate batch commands with:

list-dirs.sh finclarin_siirto | \
combine-dirs.sh 200000 | \
dirs-into-game-commands.sh "game --cores=1" "alto-xml2vrt-dirs-new.sh" 100000 > COMMANDS

For more information, see batch_scripts/README.

Then zip the source files:

zip -r finclarin_siirto.zip finclarin_siirto

Copy finclarin_siirto.zip and COMMANDS, extract finclarin_siirto.zip
and run all batch commands in COMMANDS.


Basically, VRT files are generated from XML files for a given set of directories
with the command:

  alto-xml2vrt-dirs-new.sh "DIR_1 DIR_2 ... DIR_N"

e.g.

  alto-xml2vrt-dirs-new.sh "0025-5149/1937/alto 0025-5149/1938/alto"

which will create

- outputdir/0025-5149/1937/alto/FILE_1.vrt
- outputdir/0025-5149/1937/alto/FILE_2.vrt
- ...
- outputdir/0025-5149/1937/alto/FILE_N.vrt

- outputdir/0025-5149/1938/alto/FILE_1.vrt
- outputdir/0025-5149/1938/alto/FILE_2.vrt
- ...
- outputdir/0025-5149/1938/alto/FILE_N.vrt

Each VRT file will be a concatenation of files that use the same metadata file.

Then analyze the VRT files. Splitting long sentences is advisable. For example
vrt-conll09-mend does this by default after the limit of 1 000 words is reached.

After analyzing, search for possible splitted sentences and rename their
ids with command

  ./check-and-renumber-sentences.sh outputdir

Then generate the corpus package for each year YEAR with command

  ... outputdir/*/YEAR/*/*.vrt
